# ğŸ—ï¸ 9.3 Context Managers (`with`)

Context managers allow you to **manage resources safely**, like files or database connections, ensuring they are **properly cleaned up** after use.

---

## ğŸ”‘ Basic Syntax

```python
with open("file.txt", "w") as f:
    f.write("Hello World")
```

âœ… Automatically handles **opening and closing** the file, even if an error occurs.

---

## ğŸ”‘ 1. Without Context Manager

```python
f = open("file.txt", "w")
try:
    f.write("Hello World")
finally:
    f.close()
```

âœ… Works, but requires **more boilerplate code**.

---

## ğŸ”‘ 2. Using `with`

```python
with open("file.txt", "w") as f:
    f.write("Hello World")
# file automatically closed here
```

âœ… Cleaner, safer, and more readable.

---

## ğŸ”‘ 3. Custom Context Manager using `__enter__` and `__exit__`

```python
class MyContext:
    def __enter__(self):
        print("Entering context")
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        print("Exiting context")

with MyContext() as mc:
    print("Inside context")
```

Output:

```
Entering context
Inside context
Exiting context
```

âœ… Useful for **custom resource management**.

---

## ğŸ”‘ 4. Using `contextlib` Decorator

```python
from contextlib import contextmanager

@contextmanager
def my_context():
    print("Entering")
    yield
    print("Exiting")

with my_context():
    print("Doing work")
```

Output:

```
Entering
Doing work
Exiting
```

---

## ğŸ¯ Mini Project: File Reader Context Manager

```python
from contextlib import contextmanager

@contextmanager
def open_file(filename, mode):
    f = open(filename, mode)
    try:
        yield f
    finally:
        f.close()
        print(f"{filename} closed safely")

with open_file("example.txt", "w") as file:
    file.write("Hello, Context Manager!")
```

âœ… Ensures the file is **always closed safely**.

---

## ğŸ§  Best Practices

* Use `with` for **files, sockets, database connections**
* Always ensure **resources are cleaned up**
* Use `contextlib` for **custom context managers**
* Keep `__enter__` and `__exit__` simple and predictable
